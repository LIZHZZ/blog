<!DOCTYPE html>
<html>
<head>
    <title>è®¿é—®ç»Ÿè®¡è°ƒè¯•å·¥å…·</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .status { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .test-button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        .test-button:hover { background: #0056b3; }
        .log { background: #f8f9fa; border: 1px solid #dee2e6; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ è®¿é—®ç»Ÿè®¡è°ƒè¯•å·¥å…·</h1>
        
        <div class="info">
            <h3>ğŸ“‹ è°ƒè¯•æ­¥éª¤ï¼š</h3>
            <ol>
                <li>ç‚¹å‡»ä¸‹é¢çš„æµ‹è¯•æŒ‰é’®æ£€æŸ¥å„é¡¹åŠŸèƒ½</li>
                <li>æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—äº†è§£è¯¦ç»†çŠ¶æ€</li>
                <li>è®¿é—®åšå®¢é¡µé¢æŸ¥çœ‹å®é™…æ•ˆæœ</li>
            </ol>
        </div>

        <div id="status-container">
            <div class="status info">ç­‰å¾…æµ‹è¯•...</div>
        </div>

        <div style="margin: 20px 0;">
            <button class="test-button" onclick="testBusuanzi()">æµ‹è¯•ä¸è’œå­ç»Ÿè®¡</button>
            <button class="test-button" onclick="testLocalStorage()">æµ‹è¯•æœ¬åœ°å­˜å‚¨</button>
            <button class="test-button" onclick="testNetwork()">æµ‹è¯•ç½‘ç»œè¿æ¥</button>
            <button class="test-button" onclick="clearData()">æ¸…é™¤æ‰€æœ‰æ•°æ®</button>
        </div>

        <div>
            <h3>ğŸ“Š å½“å‰æ•°æ®ï¼š</h3>
            <div id="current-data">
                <p>æ€»è®¿é—®é‡: <span id="current-pv">-</span></p>
                <p>æ€»è®¿å®¢æ•°: <span id="current-uv">-</span></p>
                <p>æœ¬é¡µè®¿é—®: <span id="current-page">-</span></p>
                <p>æœ¬åœ°è®¡æ•°: <span id="current-local">-</span></p>
            </div>
        </div>

        <div>
            <h3>ğŸ“ è°ƒè¯•æ—¥å¿—ï¼š</h3>
            <div id="log" class="log"></div>
        </div>

        <div style="margin-top: 20px; text-align: center;">
            <a href="http://localhost:4000/blog/" target="_blank" style="display: inline-block; background: #28a745; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">
                ğŸ” æŸ¥çœ‹åšå®¢å®é™…æ•ˆæœ
            </a>
        </div>
    </div>

    <script>
        let logContainer = document.getElementById('log');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.style.color = type === 'error' ? '#721c24' : type === 'success' ? '#155724' : '#0c5460';
            logEntry.textContent = `[${timestamp}] ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
            console.log(message);
        }
        
        function updateStatus(message, type = 'info') {
            const container = document.getElementById('status-container');
            container.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function updateCurrentData() {
            document.getElementById('current-pv').textContent = document.getElementById('busuanzi_value_site_pv')?.textContent || '-';
            document.getElementById('current-uv').textContent = document.getElementById('busuanzi_value_site_uv')?.textContent || '-';
            document.getElementById('current-page').textContent = document.getElementById('busuanzi_value_page_pv')?.textContent || '-';
            document.getElementById('current-local').textContent = localStorage.getItem('localVisitCount') || '0';
        }
        
        function testBusuanzi() {
            log('å¼€å§‹æµ‹è¯•ä¸è’œå­ç»Ÿè®¡...');
            updateStatus('æ­£åœ¨æµ‹è¯•ä¸è’œå­ç»Ÿè®¡...', 'info');
            
            try {
                const script = document.createElement('script');
                script.src = '//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js';
                script.onload = function() {
                    log('ä¸è’œå­ç»Ÿè®¡è„šæœ¬åŠ è½½æˆåŠŸ', 'success');
                    updateStatus('ä¸è’œå­ç»Ÿè®¡åŠ è½½æˆåŠŸï¼', 'success');
                    
                    // æ£€æŸ¥å…¨å±€å˜é‡
                    if (typeof bszCaller !== 'undefined') {
                        log('bszCaller å˜é‡å¯ç”¨', 'success');
                    } else {
                        log('bszCaller å˜é‡ä¸å¯ç”¨', 'warning');
                    }
                    
                    updateCurrentData();
                };
                script.onerror = function() {
                    log('ä¸è’œå­ç»Ÿè®¡è„šæœ¬åŠ è½½å¤±è´¥', 'error');
                    updateStatus('ä¸è’œå­ç»Ÿè®¡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥', 'error');
                };
                document.head.appendChild(script);
            } catch (error) {
                log('ä¸è’œå­ç»Ÿè®¡æµ‹è¯•å‡ºé”™: ' + error.message, 'error');
                updateStatus('ä¸è’œå­ç»Ÿè®¡æµ‹è¯•å‡ºé”™', 'error');
            }
        }
        
        function testLocalStorage() {
            log('æµ‹è¯•æœ¬åœ°å­˜å‚¨...');
            try {
                const testKey = 'test_' + Date.now();
                localStorage.setItem(testKey, 'test_value');
                const retrieved = localStorage.getItem(testKey);
                localStorage.removeItem(testKey);
                
                if (retrieved === 'test_value') {
                    log('æœ¬åœ°å­˜å‚¨æµ‹è¯•æˆåŠŸ', 'success');
                    updateStatus('æœ¬åœ°å­˜å‚¨åŠŸèƒ½æ­£å¸¸', 'success');
                } else {
                    log('æœ¬åœ°å­˜å‚¨æµ‹è¯•å¤±è´¥', 'error');
                    updateStatus('æœ¬åœ°å­˜å‚¨åŠŸèƒ½å¼‚å¸¸', 'error');
                }
            } catch (error) {
                log('æœ¬åœ°å­˜å‚¨æµ‹è¯•å‡ºé”™: ' + error.message, 'error');
                updateStatus('æœ¬åœ°å­˜å‚¨ä¸å¯ç”¨', 'error');
            }
            updateCurrentData();
        }
        
        function testNetwork() {
            log('æµ‹è¯•ç½‘ç»œè¿æ¥...');
            fetch('//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js')
                .then(response => {
                    if (response.ok) {
                        log('ç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œå¯ä»¥è®¿é—®ä¸è’œå­æœåŠ¡', 'success');
                        updateStatus('ç½‘ç»œè¿æ¥æ­£å¸¸', 'success');
                    } else {
                        log('ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼ŒçŠ¶æ€ç : ' + response.status, 'warning');
                        updateStatus('ç½‘ç»œè¿æ¥å¼‚å¸¸', 'warning');
                    }
                })
                .catch(error => {
                    log('ç½‘ç»œè¿æ¥å¤±è´¥: ' + error.message, 'error');
                    updateStatus('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®', 'error');
                });
        }
        
        function clearData() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰ç»Ÿè®¡æ•°æ®å—ï¼Ÿ')) {
                localStorage.removeItem('localVisitCount');
                log('å·²æ¸…é™¤æœ¬åœ°ç»Ÿè®¡æ•°æ®', 'warning');
                updateStatus('æ•°æ®å·²æ¸…é™¤', 'warning');
                updateCurrentData();
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            log('è°ƒè¯•å·¥å…·å·²åŠ è½½');
            testLocalStorage();
            updateCurrentData();
        });
        
        // å®šæœŸæ›´æ–°æ•°æ®æ˜¾ç¤º
        setInterval(updateCurrentData, 2000);
    </script>
</body>
</html>

